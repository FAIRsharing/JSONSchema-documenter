<div class="main_container" id="{{parent | removeExtraStr}}">
    <h1 class="container">
        <div class="row">
            <div class="col-10 titleText">{{json_source.title}} </div>


            <div class="col-2" ng-if="parent != ''">
                <span class="fas fa-file-alt" ng-click="ctrl.displayItem('json_'+parent, ctrl.loaded_specs[parent])"></span>
            </div>
            <div class="jsonDump" ng-show="ctrl.displayedSpec[0] === 'json_'+parent && parent != ''" id="json_{{parent}}">
                <div class="jsonHeader">
                    <i class="fas fa-times" ng-click="ctrl.displayItem('json_'+parent, ctrl.loaded_specs[parent])"> </i>
                    <i class="fas fa-clipboard" ng-click-copy="{{ctrl.displayedSpec[1]}}"></i>
                </div>
                <div class="jsonContainer">
                    <pre>{{ctrl.displayedSpec[1]| json:4}}</pre>
                </div>
            </div>

            <div class="col-2" ng-if="parent === ''">
                <span class="fas fa-file-alt" ng-click="ctrl.displayItem('mainItem', ctrl.main_spec)"></span>
            </div>

            <div class="jsonDump" ng-show="ctrl.displayedSpec[0] === 'mainItem' && parent === ''" id="mainItem">
                <div class="jsonHeader">
                    <i class="fas fa-times" ng-click="ctrl.displayItem('mainItem', ctrl.main_spec)"> </i>
                    <i class="fas fa-clipboard" ng-click-copy="{{ctrl.displayedSpec[1]}}"></i>
                </div>
                <div class="jsonContainer">
                    <pre>{{ctrl.displayedSpec[1]| json:4}}</pre>
                </div>
            </div>



        </div>
    </h1>

    <div class="metadata">
        <h2> Schema Metadata </h2>
        <ul>
            <li ng-if="json_source['$schema']">
                <b>$schema : </b> {{json_source['$schema']}}
            </li>

            <li ng-repeat="(key, item) in json_source"
                ng-if="key != 'properties' && key != 'referencedFrom'">

                <!-- key is not 'id' and is not 'required' -->
                <div ng-if="key != 'id' && key != 'required' ">
                    <b>{{key}}: </b>

                    <!-- value is a string -->
                    <span ng-if="(item | typeOf) === 'string' || (item | typeOf) === 'number'">{{item}}</span>

                    <!-- value is an object -->
                    <div ng-if="(item | typeOf) === 'object'">
                        <div class="container" style="margin-bottom: 15px;">
                            <div class="row">
                                <div class="col-6">
                                    <div class="card"
                                         ng-repeat="(objectName, objectVal) in item"
                                         id="{{json_source['id'] + '_definitions_' + objectName}}">
                                        <div class="card-header">
                                            {{objectName}}
                                        </div>
                                        <div class="card-body">
                                            <div class="" ng-repeat="(defKey, defVal) in objectVal">
                                                <b>{{defKey}}:</b>

                                                <span ng-if="(defVal | typeOf) === 'string' || (defVal | typeOf) === 'number'">
                                                    {{defVal}}
                                                </span>

                                                <div ng-if="(defVal | typeOf) === 'object'">

                                                    <div class="container">
                                                        <div class="row">

                                                            <div class="miniCard col-12" ng-repeat="(fieldName, fieldVal) in defVal">
                                                                <div class="card">
                                                                    <div class="card-body">
                                                                        <h6>
                                                                            <label class="descriptionLabel">
                                                                            {{fieldName}}
                                                                            </label>
                                                                        </h6>
                                                                        <h6 class="card-subtitle">
                                                                            {{fieldVal}}
                                                                        </h6>
                                                                    </div>
                                                                </div>
                                                            </div>

                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- value is false -->
                    <span ng-if="item === false">
                        false
                    </span>
                </div>

                <!-- key is 'id' -->
                <div ng-if="key === 'id' ">
                    <b>{{key}} : </b>
                    <a class="link" ng-href="{{item}}" target="_blank">{{item}}</a>
                </div>

                <!-- key is 'required' -->
                <div ng-if="key === 'required' ">
                    <b>{{key}} : </b>
                    <span ng-repeat="field in item"> {{field}} <i ng-if="!$last">,</i> </span>
                </div>


            </li>

            <li ng-if="parent != ''">
                <b>Referenced from: </b>

                <ul ng-if="ctrl.display==='table'">
                    <li ng-repeat="(childKey, childVal) in json_source.referencedFrom">
                        {{childKey}} : <span ng-repeat="item in childVal">{{item}} <span ng-if="!$last">, </span></span>
                    </li>
                </ul>

                <div class="container" ng-if="ctrl.display==='grid'">
                    <div class="row">
                        <div class=" miniCard col-lg-2 col-sm-6 col-md-6" ng-repeat="(childKey, childVal) in json_source.referencedFrom">
                            <div class="card">
                                <div class="card-body">
                                    <h6 class="card-subtitle mb-2 text-muted">
                                        <label class="descriptionLabel">{{childKey}}: </label>
                                    </h6>
                                    <h6 class="card-subtitle mb-2 text-muted">
                                        <!--<label class="descriptionLabel">Referencing fields: </label>-->
                                        <span ng-repeat="item in childVal">
                                            {{item}}<span ng-if="!$last">, </span>
                                        </span>
                                    </h6>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </li>
        </ul>
    </div>


    <div class="main_container">
        <h2> Schema Fields </h2>
        <div schema-fields="json_source.properties"
             parent-key="parent"
             inner-link="json_source.id"
             display-type="ctrl.display">
        </div>

    </div>

</div>